-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

-- @SINCE-LF-FEATURE DAML_INTERFACE
-- TODO(MA): https://github.com/digital-asset/daml/issues/14560
-- This error message should point to the interface, not the template
-- @ERROR Template InterfaceRetroRequiresError:T is missing an implementation of interface InterfaceRetroRequiresError:A required by interface InterfaceRetroRequiresError:B

-- | Check that interface hierarchy is enforced. So if interface B requires
-- interface A, and some template implements B, then it must implement A.
module InterfaceRetroRequiresError where

interface A where

template T
  with
    p : Party
  where
    signatory p

interface B requires A where
  {-
  -- TODO(MA): https://github.com/digital-asset/daml/issues/14560
  -- Switch to daml syntax once the parser supports retroactive interface implementations

  retroactively implements T where
  -}
_coimplements_T_B :
  DA.Internal.Desugar.CoImplementsT T B
_coimplements_T_B = DA.Internal.Desugar.CoImplementsT
instance DA.Internal.Desugar.HasToInterface T B where
  _toInterface = GHC.Types.primitive @"EToInterface"
instance DA.Internal.Desugar.HasFromInterface T B where
  fromInterface = GHC.Types.primitive @"EFromInterface"
  unsafeFromInterface = GHC.Types.primitive @"EUnsafeFromInterface"
